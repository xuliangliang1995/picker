# 多线程基础知识
![image.png](https://picker-oss.oss-cn-beijing.aliyuncs.com/20200712/e52c84340eb52a94de7982f4c062a2cb.png_target)

## 1. 进程和线程的概念

通俗上来讲（即从人的角度来看），进程指的是一个运行中的应用程序。在 windows 系统中，通常我们通过双击桌面上的应用图标，来启动一个对应的进程。而线程呢，则相当于进程中的一个执行任务，一个进程可以同时拥有多个线程。

从操作系统的角度来讲，进程是操作系统资源分配的基本单位。当一个进程启动的时候，操作系统会为它分配独立的资源空间。线程是一种特殊的进程，也称为轻量级进程，线程是操作系统任务调度的最小单位。一个进程可以创建多个线程，线程可以共享进程的资源空间。



## 2. 为什么要使用多线程

1. 充分利用多核处理器的优势

   现代处理器往往都具有多个 CPU 核心，使用多线程可以充分利用 CPU 资源，从而提交程序性能。

> 既然我们已经将充分利用多核处理器作为第一条理由来讲，那下边的都默认指单核处理器。

2. 程序的阻塞

   阻塞，是指当程序由于某些原因（比如，磁盘IO，网络等）导致无法继续执行下去，从而将线程挂起，待到条件满足后再继续执行。使用多线程可以在线程阻塞期间切换到别的线程继续工作，从而提高程序执行效率。

3. 人机交互的需要

   假使我们只有一个线程的话，那我们依次执行上传文件和取消上传操作，取消操作必须等文件上传之后才能继续执行。使用多线程，则可以及时地中断上传并给予用户反馈。

4. 更好的编程模型



## 3. 多线程面临的问题

1. 频繁的上下文切换

   CPU 通过给每个现场分配时间片，不停地切换线程执行，让我们感觉多个线程是同时执行的。在线程切换之前，CPU 需要保存上一个任务的执行状态，以便下次切换回这个任务时，可以再加载这个任务的状态来继续执行。从保存任务状态到再加载的过程。称之为一次上下文切换。上下文切换会带来额外的系统开销，频繁的上下文切换会影响程序的性能。

2. 死锁

   多线程为保证对共享变量读取和修改的安全性，往往需要对程序加锁，不合理的加锁过程，有可能会导致死锁。

   